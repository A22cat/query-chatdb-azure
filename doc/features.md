# Qnect (キュネクト)- 機能概要

## 1. Azureサービスの使用方法

Azureの多様なPaaSサービスを連携させることで、高度な対話型DBクエリ体験を構築しました。使用したMicrosoft Azureは以下の役割を担っています。

- Azure OpenAI Service (Chatモデル & Embeddingモデル):  
本システムの中心的な役割を果たします。Chat用モデルは、1.ユーザーの自然言語をSQLに変換、2.DBからの実行結果を平易な言葉で要約、3.過去の文脈を踏まえた対話応答、という3つの中心的な役割を担います。一方、Embedding用モデルは、対話の要約を数値ベクトルに変換し、後述するAzure AI Searchでの意味検索を可能にします。

- Azure AI Search:
システムの履歴を保持し、検索を支援します。対話履歴をテキストとベクトルで格納し、ハイブリッド検索を実行します。ユーザーからの新しい質問に対し、意味的に最も関連性の高い過去の対話を高速に発見します。そして、関連性の高い履歴をコンテキストとしてAzure OpenAIに渡すことで、文脈を理解した精度の高い応答を実現しています。

- Azure Cosmos DB:
全ての対話履歴（質問、生成SQL、要約、タイムスタンプ等）をJSON形式で保存し、必要に応じて参照可能な履歴データベースです。これにより、対話履歴を完全に記録し、Azure AI Searchのインデックスに活用されてます。

- Azure SQL Database:
ユーザーが照会したい製品カタログ、従業員、販売記録などのビジネスデータが格納されているデータベースです。Azure OpenAIが生成したSQLクエリは、このデータベースに対して実行されます。

- Azure App Service:
Python（Streamlit）で構築されたWebアプリケーションの実行環境です。ユーザーインターフェースを提供し、Azureサービスとの連携を調整しながらアプリケーションの実行環境を支えるプラットフォームです。


## 2. 主な機能（デモ動画との連携）

「Qnect」は、デモ動画で示された通り、以下の直感的な機能を提供します。

* **\[00:20～\] ① 自然言語でのSQLクエリ生成**
  * ユーザーは「各製品の総売上金額を計算し、金額が多い順に並べて。」といった**日本語の質問（自然言語）**を入力するだけです。
  * Azure OpenAIが質問の意図を瞬時に解析し、最適なSQLクエリを自動で生成・表示します。これにより、SQLの知識が一切不要になります。

* **\[00:50～\] ② データベースからのデータ取得とAIによる要約**
  * 生成されたSQLを実行し、Azure SQL Databaseからリアルタイムにデータを取得します。
  * 取得したデータ（テーブル形式）を表示するだけでなく、AIがその**データを分析し、「要約と結果の説明」を自動で生成**します。これにより、ユーザーはデータの要点を素早く把握し、次のアクションに繋げることができます。

* **\[01:50～\] ③ 対話形式での深掘り分析とセキュリティ**
  * 初回の結果に対して、「総売上が3番目に多い製品を購入した顧客情報を教えて」といった**追加の質問を対話形式で入力**できます。システムは前の会話の文脈を理解し、追加のクエリを生成します。
  * **高度なマスキング機能**を実装。実行結果に含まれる個人情報（例: 顧客の性別や誕生日）を自動でマスキング処理し、情報漏洩のリスクを防ぎながら安全なデータ活用を実現します。

* **\[03:15～\] ④ 対話の履歴検索（ハイブリッド検索でキーワードとベクトル(意味の近さ)の両方で検索）**
  * 過去の質問や実行結果は、**Azure AI SearchとCosmos DBにナレッジとして蓄積**されます。
  * キーワード検索(Cosmos DB)だけでなく、AIによる**ベクトル類似検索**(Azure AI Search)を組み合わせたハイブリッド検索が可能です。「総売上を計算して」といった曖昧なキーワードでも、意味を理解して関連性の高い過去の分析結果を瞬時に見つけ出します。

* **\[04:15～\] ⑤ DBスキーマの動的な更新**
  * データベースのテーブル構造が変更された場合でも、UI上から簡単な操作でスキーマ定義を最新の状態に更新できます。これにより、常に正確な情報に基づいたSQL生成が可能となり、メンテナンス性も確保しています。


## 3. 解決したい課題

本ソリューションは、企業が直面する以下の課題を解決します。

企業内の業務データベースは情報が豊富である一方、専門的な知識がないと活用が難しく、日常業務での意思決定や問い合わせ対応に活かしきれていません。これにより、必要な情報にすぐにアクセスできない、IT部門へ依頼が発生するなど、業務のタイムロスが生じています。こうした状況を改善し、**誰もが専門知識なしで、自然言語を用いて簡単に業務データへアクセスできる環境**の実現を目指します。

## 4. ビジネスへの貢献

「Qnect」は、データ活用を促進し、ビジネスに次のような価値をもたらします。

| ユースケース | 効果 | 
| :--- | :--- | 
| **営業担当者の在庫確認** | 顧客からの問い合わせに対し、チャット形式で数秒で販売データや在庫状況を確認。**リードタイムを大幅に短縮し、顧客対応力を向上**させます。 | 
| **マーケティング担当者の傾向分析** | ノーコードで売れ筋商品や顧客セグメントを把握。**データに基づくマーケティング施策を迅速に立案**することに貢献します。 | 
| **経営者の意思決定支援** | 複数データベースを横断した要約情報を自然言語で瞬時に取得。**膨大な分析時間を削減し、迅速かつ的確な経営判断を支援**します。 | 

全社員がデータアナリストのように振る舞える環境を提供することで、組織全体のデータリテラシーを向上させ、IT部門の負荷を軽減します。これにより、新たなビジネスチャンスの発見や業務プロセスの抜本的な改善に繋がり、企業の競争力を大きく高める可能性を秘めています。

## 5. スケーラビリティ
- 本システムでは、Azure SQL Database の情報スキーマを参照し、テーブル構造の変化に応じて動的にテーブル定義を取得・反映可能とする設計を採用しています。これによりスキーマ変更にも柔軟に対応し、運用時の拡張性と保守性を両立しています。

- Azure OpenAIのChatモデル（gpt-4、gpt-4oなど）の応答品質と処理性能を比較検証でき、トークン制限や処理速度に応じて動的にモデルを選択可能な構成を設計しています。今後のAPIアップデートにも柔軟に対応できる拡張性を備えています。

- 本システムは、Azureのサービス（Azure OpenAI, Azure SQL Database, Azure AI Search, Azure Cosmos DB, Azure App Service）を採用しています。これらのサービスはアクセス数やデータ量の増加に応じてシームレスにスケールアップ/ダウンが可能です。これにより、初期はスモールスタートし、ビジネスの成長に合わせて柔軟かつコスト効率よくシステムを拡張していくことができます。
